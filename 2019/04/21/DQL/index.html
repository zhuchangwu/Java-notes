<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>DQL | blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="常见的sql分类五种分类  DDL (Data Definition Language)数据库定义语言 DML (Data Manipulation Language)数据操作语言 DCL (Data Control Language)数据控制语言 TCL (Transactional Control Language) 事务控制语法 DQL (Data Query Language) 数据查询语">
<meta name="keywords" content="Oracle">
<meta property="og:type" content="article">
<meta property="og:title" content="DQL">
<meta property="og:url" content="http://yoursite.com/2019/04/21/DQL/index.html">
<meta property="og:site_name" content="blog">
<meta property="og:description" content="常见的sql分类五种分类  DDL (Data Definition Language)数据库定义语言 DML (Data Manipulation Language)数据操作语言 DCL (Data Control Language)数据控制语言 TCL (Transactional Control Language) 事务控制语法 DQL (Data Query Language) 数据查询语">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-04-22T08:26:26.049Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DQL">
<meta name="twitter:description" content="常见的sql分类五种分类  DDL (Data Definition Language)数据库定义语言 DML (Data Manipulation Language)数据操作语言 DCL (Data Control Language)数据控制语言 TCL (Transactional Control Language) 事务控制语法 DQL (Data Query Language) 数据查询语">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
  
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img lazy-src="/img/headportrait.jpg" class="js-avatar">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">赐我白日梦</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/categories">分类</a></li>
				        
							<li><a href="/archives">归档</a></li>
				        
							<li><a href="/about">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="http://github.com/zhuchangwu" title="github">github</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/Elasticsearch/" style="font-size: 12.5px;">Elasticsearch</a> <a href="/tags/Hibernate-Validator/" style="font-size: 10px;">Hibernate-Validator</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/JWT/" style="font-size: 10px;">JWT</a> <a href="/tags/JavaScript/" style="font-size: 12.5px;">JavaScript</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Oracle/" style="font-size: 17.5px;">Oracle</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/Redis/" style="font-size: 12.5px;">Redis</a> <a href="/tags/Spring/" style="font-size: 10px;">Spring</a> <a href="/tags/SpringMvc/" style="font-size: 12.5px;">SpringMvc</a> <a href="/tags/Thymeleaf/" style="font-size: 10px;">Thymeleaf</a> <a href="/tags/java/" style="font-size: 17.5px;">java</a> <a href="/tags/mybatis/" style="font-size: 10px;">mybatis</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/多线程/" style="font-size: 20px;">多线程</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.voidking.com">VoidKing</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/u/9f179465dd2b">简书</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/voidking">SegmentFault</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/voidking">博客园</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/c0416">CSDN</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.iots.vip">Alliot&#39;s Blog</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">虽然还没想好怎么夸自己，但总觉得这里放点东西比较和谐。。。</div>
				</section>
				
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">赐我白日梦</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/headportrait.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">赐我白日梦</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/categories">分类</a></li>
		        
					<li><a href="/archives">归档</a></li>
		        
					<li><a href="/about">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="http://github.com/zhuchangwu" title="github">github</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-DQL" class="article article-type-post" itemscope="" itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/04/21/DQL/" class="article-date">
  	<time datetime="2019-04-21T12:34:05.000Z" itemprop="datePublished">2019-04-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      DQL
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Oracle/">Oracle</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Oracle/">Oracle</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">	
      
	  
		
		
        <p>常见的sql分类五种分类</p>
<ol>
<li>DDL (Data Definition Language)数据库定义语言</li>
<li>DML (Data Manipulation Language)数据操作语言</li>
<li>DCL (Data Control Language)数据控制语言</li>
<li>TCL (Transactional Control Language) 事务控制语法</li>
<li>DQL (Data Query Language) 数据查询语言</li>
</ol>
<blockquote>
<p><strong>有时候会把DQL归入到DML中, 因为DML常见的操作是针对数据表中数据的 增删改 ,而查数据的DQL,同样是基于表中数据级别的操作,所以真的把DQL归入到DML也说的过去,但是DQL 单条select语句的复杂程度就远远高于 DDL DML DCL TCL中的任意一种,所以我单独整理出来</strong></p>
</blockquote>
<a id="more"></a>
<h3 id="Select知识图谱"><a href="#Select知识图谱" class="headerlink" title="Select知识图谱"></a>Select知识图谱</h3><p><strong>如何写查询sql?</strong> </p>
<p>–  一条查询语句,最容易确定就是 要查询的结果是什么! 也就是 select 后面紧跟的信息;<br>–  数据从哪里获取?  from XXX表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 最简单的查询 ,`查询某某某,且表中的字段` 简单的没话说</span></span><br><span class="line">   <span class="comment">-- select XXX from 表名</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">-- 如果让查询  查询某某某 ,出现了一个 的  结果就不一样了</span></span><br><span class="line">    <span class="comment">-- 内连接:</span></span><br><span class="line">         <span class="comment">-- 隐式内连接</span></span><br><span class="line">            <span class="comment">-- 等值内连接</span></span><br><span class="line">            <span class="comment">-- 不等值内连接</span></span><br><span class="line">            <span class="comment">-- 自表连接(查询表中的A字段需要B字段辅助)</span></span><br><span class="line">         <span class="comment">-- 显示内连接</span></span><br><span class="line">            <span class="comment">-- 关键字 inner join on XXX=YYY</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 外连接:</span></span><br><span class="line">         <span class="comment">-- 左外连接</span></span><br><span class="line">            <span class="comment">-- left join on : 特点, 显示的结果为左表中的全部数据加上右表中匹配上的数据(没有的字段为null)</span></span><br><span class="line">         <span class="comment">-- 右外连接</span></span><br><span class="line">            <span class="comment">-- right join on : 特点, 右表中的全部数据+ 左表中匹配上的数据 (没有的字段为null)</span></span><br><span class="line">    <span class="comment">-- 自然连接 antural join</span></span><br><span class="line">        <span class="comment">--  默认去除笛卡尔积的条件是 两个表的相同字段 相等(存在多个字段,多个字段分别相等)</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">-- 如果是我们查询某某的某某某 ,一般是子查询</span></span><br><span class="line">    <span class="comment">-- 单行子查询</span></span><br><span class="line">        <span class="comment">-- 特点: 查询的结果是一行一列</span></span><br><span class="line">        <span class="comment">-- 通用的操作符: &gt; &gt;= &lt; &lt;= != &lt;&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">-- 多行子查询</span></span><br><span class="line">        <span class="comment">-- 特点: 查询的结果是多行多列</span></span><br><span class="line">        <span class="comment">-- 常用的关键字: or , in , all , exits , not in (&lt;&gt;all) , any</span></span><br><span class="line">        <span class="comment">-- 注意点: 多行子查询要规避null,   not in (子查询) 这时子查询结果如果有null, 整个的结果为空</span></span><br><span class="line">            <span class="comment">-- 错误实例: select * from emp where empno not in (select mgr from emp);</span></span><br><span class="line">            <span class="comment">-- 错误点: 因为子查询结果中存在null,所以和前面的关键字 not in 结合,结果为 空</span></span><br><span class="line">            <span class="comment">-- 解决: 加添加, where mgr is not null</span></span><br></pre></td></tr></table></figure>
<h3 id="exits-关键字"><a href="#exits-关键字" class="headerlink" title="exits 关键字"></a>exits 关键字</h3><p>– exists  (查询语言) , 在大数据级别下,它的效率很高!!!<br>– 查询到结果  true   否则 false  </p>
<p>例:查询有员工的部门信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> DEPT  d <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> * <span class="keyword">from</span> emp e <span class="keyword">where</span> d.DEPTNO=e.DEPTNO);</span><br></pre></td></tr></table></figure>
<h3 id="虚表-伪标"><a href="#虚表-伪标" class="headerlink" title="虚表/伪标"></a>虚表/伪标</h3><p>dual是Oracle中的虚表,它的存在主要是为了补全语法结构(select XXX  后面没有from 的话,报错 ), 里面只有一行一列 存着个X</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span>+<span class="number">1</span>; // 在Oracle中会报错, 而Mysql不会报错</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span>+<span class="number">1</span> <span class="keyword">from</span> dual; // 添加From 关键字+ 虚表 dual 补全语法结构</span><br></pre></td></tr></table></figure>
<h3 id="伪列-rownum"><a href="#伪列-rownum" class="headerlink" title="伪列 rownum"></a>伪列 rownum</h3><p>就是Oracle 特有的用来表示行号的, 默认起始值为1 ,有了结果再 +1<br>–  练习; 找到员工表中,工资最高的前三名   – 添加上一个条件 rownum&lt;4 就行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 空格+新表名  里面的表可以用里面的表的别名  反之不可以</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ROWNUM</span> ,table1.*  <span class="keyword">from</span> ( <span class="keyword">select</span> *  <span class="keyword">from</span> EMP e <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) table1  <span class="keyword">where</span> <span class="keyword">rownum</span>&lt;<span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<p>–  练习: 查询员工表中的 薪水大于本部门的平均薪水的员工<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> DEPTNO ,<span class="keyword">avg</span>(sal) avgsal <span class="keyword">from</span> EMP <span class="keyword">group</span> <span class="keyword">by</span> deptno) table1 , emp <span class="keyword">where</span> emp.DEPTNO=table1.DEPTNO <span class="keyword">and</span> emp.sal&gt;table1.avgsal;</span><br></pre></td></tr></table></figure></p>
<p>– 在Oracle中的分页<br>    – mysql中的分页使用limit<br>    – oracle只能使用rownum<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">rownum</span> hanghao,emp.* <span class="keyword">from</span> EMP) tt <span class="keyword">where</span> tt.hanghao <span class="keyword">between</span> <span class="number">1</span> <span class="keyword">and</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="伪列-rowid"><a href="#伪列-rowid" class="headerlink" title="伪列 rowid"></a>伪列 rowid</h3><p>伪列,每行记录存放的真实物理地址</p>
<p>简单使用,查看emp表里面每行的物理地址</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">rowid</span> ,e.* <span class="keyword">from</span> EMP e;</span><br></pre></td></tr></table></figure>
<p>– 去除(删除)  表中的重复记录<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> p(<span class="keyword">name</span> varchar2(<span class="number">20</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> p(<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="string">'张三'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> p(<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="string">'张三'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> p(<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="string">'李四'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ROWID</span> <span class="keyword">from</span> p;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除,rowid 是从小到大排序的, 我们只要  rowid 小的</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> p <span class="keyword">where</span> p.ROWID&gt;(<span class="keyword">select</span> <span class="keyword">min</span>(<span class="keyword">rowid</span>) <span class="keyword">from</span> p p2 <span class="keyword">where</span> p.name=p2.name);</span><br></pre></td></tr></table></figure></p>
<h3 id="并集运算"><a href="#并集运算" class="headerlink" title="并集运算"></a>并集运算</h3><p>– 交并补</p>
<p>– 例: 工资大于1500 ,或者20号部门下的员工<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> EMP <span class="keyword">where</span> emp.sal&gt;<span class="number">1500</span> <span class="keyword">or</span> EMPNO=<span class="number">20</span>;</span><br></pre></td></tr></table></figure></p>
<p>– 并集 union  去重并且排序<br>– 并集 union all 不去重<br>—差集 minus  A minux B  A-B<br>– 注意点:<br>    – 1.列的类型要一致<br>           –    2. 按顺序书写<br>           –    3. 列的数量要一致,如果不一致,会用空值填充  </p>
<p>用法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> XXX <span class="keyword">union</span> , <span class="keyword">union</span>, <span class="keyword">minus</span> <span class="keyword">select</span> XXX;</span><br></pre></td></tr></table></figure>
<h3 id="别名查询"><a href="#别名查询" class="headerlink" title="别名查询"></a>别名查询</h3><p>as关键字可以省略</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename <span class="keyword">as</span> <span class="string">"姓   名"</span>, sal <span class="keyword">as</span> 工资 <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h3 id="取出重复数据"><a href="#取出重复数据" class="headerlink" title="取出重复数据"></a>取出重复数据</h3><p>distinct关键字,在select之后</p>
<h3 id="查询中的四则运算"><a href="#查询中的四则运算" class="headerlink" title="查询中的四则运算"></a>查询中的四则运算</h3><ul>
<li>select 显示字段 … ;  显示字段如果是数字，Oracle支持四则运算</li>
<li>注意：null值, 不可以做四则运算– 解决 nvl(P1,P2)函数,若P1为null,那么取P2的值</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sal*<span class="number">12</span> + comm <span class="keyword">from</span> EMP;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> sal*<span class="number">12</span> + nvl(comm,<span class="number">0</span>) <span class="keyword">from</span> EMP;</span><br></pre></td></tr></table></figure>
<h3 id="字符串的拼接符"><a href="#字符串的拼接符" class="headerlink" title="字符串的拼接符"></a>字符串的拼接符</h3><ul>
<li>Oracle中使用 || 进行字符串的拼接</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ENAME <span class="keyword">from</span> EMP;</span><br><span class="line"></span><br><span class="line">// 单引号是使用值, 双引号取别名使用</span><br><span class="line"><span class="keyword">select</span> <span class="string">'姓名:'</span>||ENAME <span class="keyword">from</span> EMP;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在mysql和oracle 中都有<strong>concat(str1,str2)</strong>函数,用于字符串拼接</p>
</blockquote>
<h3 id="条件查询-where-后面的条件"><a href="#条件查询-where-后面的条件" class="headerlink" title="条件查询(where 后面的条件)"></a>条件查询(where 后面的条件)</h3><ul>
<li>关系运算符: &gt; &gt;= &lt; &lt;= != &lt;&gt;</li>
<li>逻辑运算符: and or not</li>
<li>其他运算符: <ul>
<li>like %  匹配多个字符 _ 匹配单个字符</li>
<li>in</li>
<li>between..and… </li>
<li>is null</li>
<li>is not null</li>
</ul>
</li>
</ul>
<p>Oracle处理转义字符:<code>escape &#39;X&#39;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询名字中包含% 的学生的信息</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename=<span class="string">'%/%%'</span> escape <span class="string">'/'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="排序-order-by"><a href="#排序-order-by" class="headerlink" title="排序:order by"></a>排序:order by</h3><ul>
<li>升序:asc </li>
<li>降序:desc</li>
</ul>
<p>注意点: 排序时,空值默认会排到前面去<br>解决:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 默认</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> comm <span class="keyword">desc</span> <span class="keyword">nulls</span> <span class="keyword">first</span>;</span><br><span class="line">// 解决:</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> comm <span class="keyword">desc</span> <span class="keyword">nulls</span> <span class="keyword">last</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><ul>
<li>单行函数<ul>
<li>对行中的某一个值进行处理 <ul>
<li>数值函数</li>
<li>字符函数</li>
<li>日期函数</li>
<li>转换函数</li>
<li>通用函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>数值函数:</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">向上取整</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ceil</span>(<span class="number">45.8</span>) <span class="keyword">from</span> dual;    //46</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ceil</span>(<span class="number">-45.8</span>) <span class="keyword">from</span> dual;    //45  如果是负数,结果: -直接去小数部分</span><br><span class="line"></span><br><span class="line">去除小数</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">floor</span>(<span class="number">45.8</span>) <span class="keyword">from</span> dual;   //45</span><br><span class="line"></span><br><span class="line">保留指定位</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(<span class="number">45.82</span>,<span class="number">1</span>) <span class="keyword">from</span> dual; // 45.8</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(<span class="number">45.8</span>,<span class="number">0</span>) <span class="keyword">from</span> dual;  // 46</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(<span class="number">45.8</span>,<span class="number">-1</span>) <span class="keyword">from</span> dual; // 50</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(<span class="number">45.8</span>,<span class="number">-2</span>) <span class="keyword">from</span> dual; // 0</span><br><span class="line"></span><br><span class="line">截断</span><br><span class="line"><span class="keyword">select</span> trunc (<span class="number">45.999</span>,<span class="number">2</span>) <span class="keyword">from</span> dual; // 45.99</span><br></pre></td></tr></table></figure>
<p><strong>字符函数:</strong></p>
<ol>
<li>截取字符串 : substr(“被操作的字符串”,起始索引,长度)</li>
</ol>
<p>注意点: 不管起始索引从0开始还是1开始,都是从第一个字符开始算</p>
<ol start="2">
<li>获取字符串的长度: length(‘sdfghj’) </li>
</ol>
<p>注意从1开始计数</p>
<ol start="3">
<li>去除字符串左右两边的空格</li>
</ol>
<p>trim(‘ ghj ‘)</p>
<p><strong>日期函数</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询今天的日期</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sysdate</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">--三天后</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sysdate</span> +<span class="number">3</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 查询三个月后的日期</span></span><br><span class="line"><span class="keyword">select</span> add_months(<span class="keyword">sysdate</span>,<span class="number">3</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 注意点: 时间是本地服务器上的时间</span></span><br></pre></td></tr></table></figure>
<p><strong>转换函数</strong></p>
<ol>
<li>转数字:  字符串+数字 = 数字 &lt;==&gt; to_number(‘字符串’)</li>
<li>转字符串: to_char(数字/日期,’转换后的格式(yyyy-MM-dd / $999,999,.999)’)   </li>
<li>字符转日期: to_date(‘字符串’,’准换后的格式’)</li>
</ol>
<p><strong>通用函数</strong></p>
<ol>
<li>nv1(p1,p2)   // 如果 p1==null 返回 p2</li>
<li>nv12(p1,p2,p3)   // 如果 p1==null 返回p3 否则返回 p2</li>
<li>nullif(p1,p2)   // 如果 p1==p2  返回null 否则返回p1 </li>
<li>coalesce(p1,p2….) // 返回第一个不为空的值</li>
</ol>
<hr>
<ul>
<li>多行函数<ul>
<li>对所有列进行处理<ul>
<li>max()</li>
<li>min()</li>
<li>count()</li>
<li>sum()</li>
<li>avg()</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>注意点: avg() 平均值 受空值影响</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 求工资平均值</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(工资)/ <span class="keyword">count</span>(<span class="number">1</span>) <span class="keyword">from</span> 员工表;</span><br></pre></td></tr></table></figure>
<h3 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h3><ol>
<li>Oracle 和 Mysql 都有 — case when XXX then XXX </li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">给表中人取别名,并显示</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ename <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">    <span class="keyword">case</span> ename</span><br><span class="line">        <span class="keyword">when</span> <span class="string">'W'</span> <span class="keyword">then</span> <span class="string">'哈哈'</span> <span class="comment">-- 如果是W 改为 哈哈</span></span><br><span class="line">        <span class="keyword">when</span> <span class="string">'Q'</span> <span class="keyword">then</span> <span class="string">'呵呵'</span> <span class="comment">-- 如果是 Q 改为 呵呵</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="string">'哇哇'</span> <span class="comment">-- 其他改为 哇哇</span></span><br><span class="line">    <span class="keyword">end</span> <span class="string">'姓名'</span> <span class="comment">-- 表名改为 姓名</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Oracle 特有的 — decode()<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">decode</span>(ename,<span class="string">'ALLEN'</span>,<span class="string">'哈哈'</span>,<span class="string">'名字'</span>) <span class="keyword">from</span> EMP;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 如果是 W 改为哈哈  R 改为 哈哈</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">decode</span>(ename,<span class="string">'W'</span>,<span class="string">'哈哈'</span>,<span class="string">'R'</span>,<span class="string">'哈哈'</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="分组表达式-group-by"><a href="#分组表达式-group-by" class="headerlink" title="分组表达式 group by"></a>分组表达式 group by</h3><p>– 写法<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 分组条件 分组之后的操作 <span class="keyword">from</span> 表名 <span class="keyword">group</span> <span class="keyword">by</span> 分组的条件 <span class="keyword">having</span> 条件过滤</span><br></pre></td></tr></table></figure></p>
<p>– 分组统计所有部门的平均工资,找出平均工资大于2000的部门<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> DEPTNO, <span class="keyword">avg</span>(SAL) <span class="keyword">from</span> EMP <span class="keyword">group</span> <span class="keyword">by</span> DEPTNO <span class="keyword">having</span> <span class="keyword">avg</span>(SAL)&gt;<span class="number">2000</span>;</span><br></pre></td></tr></table></figure></p>
<p>– 错误写法<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> DEPTNO, <span class="keyword">avg</span>(SAL) <span class="keyword">avg</span> <span class="keyword">from</span> EMP <span class="keyword">group</span> <span class="keyword">by</span> DEPTNO <span class="keyword">having</span> <span class="keyword">avg</span>&gt;<span class="number">2000</span>;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>注意点1 : select后面的 是不能 声明 别名的!!!</li>
</ul>
<p>原因:  sql的书写顺序和执行顺序是不同的</p>
<p>– 书写顺序<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [分组条件] [字段] [*] [函数操作] <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件 <span class="keyword">group</span> <span class="keyword">by</span> 分组条件 <span class="keyword">having</span> 过滤条件 <span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line"><span class="string">``</span><span class="string">`    </span></span><br><span class="line"><span class="string">-- 执行顺序 </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span><span class="keyword">sql</span></span><br><span class="line"><span class="keyword">from</span> ..where...group <span class="keyword">by</span> ... having...order <span class="keyword">by</span> <span class="keyword">select</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>注意点2: select + 分组条件 + 其他操作  其中的 分组条件只能有一个</li>
<li>注意点3: where 和 having 和区别</li>
</ul>
<p>– where 后面不能接 聚合函数</p>
<p>– having在group by 后面执行 可以接聚合函数</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/04/21/DDL-DML/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          DDL--DML
        
      </div>
    </a>
  
  
    <a href="/2019/04/20/Oracle-干货/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Oracle--干货</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<div class="social-share"></div>

	<!--  css & js -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
</div>





<div class="livere">
    <!-- 来必力City版安装代码 -->
    <div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA==">
        <script type="text/javascript">
       (function(d, s) {
           var j, e = d.getElementsByTagName(s)[0];

           if (typeof LivereTower === 'function') { return; }

           j = d.createElement(s);
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;

           e.parentNode.insertBefore(j, e);
       })(document, 'script');
        </script>
    <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
    </div>
    <!-- City版安装代码已完成 -->
</div>





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2019 赐我白日梦
    	</div>
      	<div class="footer-right">
      		<p>
            <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten    
            </p>
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/mobile.js"></script>
<script src="/js/main.js"></script>


<!--百度统计的代码-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </div>
</body>
</html>